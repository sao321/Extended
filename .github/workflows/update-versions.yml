name: Update Extension Versions

on:
  push:
    branches:
      - main

permissions:
  contents: write

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Submodules
        uses: actions/checkout@v4
      - name: Install PHP
        uses: "shivammathur/setup-php@v2"
        with:
          php-version: "latest"
      - name: Get changed files
        id: changed-files-specific
        uses: tj-actions/changed-files@v40
        with:
         files: |
             src/**
         dir_names: "true"
      - name: Run step if any of the listed files above change
        if: steps.changed-files-specific.outputs.any_changed == 'true'
        run: |
         for file in ${{ steps.changed-files-specific.outputs.all_changed_and_modified_files }}; do
           composer update_version.php $file
         done